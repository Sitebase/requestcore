<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>RequestCore::send_multi_request</title>

		<link rel="stylesheet" href="../../styles/reset.css" type="text/css" media="screen" charset="utf-8">
		<link rel="stylesheet" href="../../styles/main.css" type="text/css" media="screen" charset="utf-8">
		<link rel="stylesheet" href="../../styles/syntax.css" type="text/css" media="screen" charset="utf-8">

	    <script src="../../scripts/jquery-1.4.2.min.js" type="text/javascript" charset="utf-8"></script>
	    <script src="../../scripts/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
	    <script src="../../scripts/main.js" type="text/javascript" charset="utf-8"></script>
	    <script src="../../scripts/chili/jquery.chili-2.2.js" type="text/javascript" charset="utf-8"></script>
	    <script src="../../scripts/chili/recipes.js" type="text/javascript" charset="utf-8"></script>

	</head>
	<body class="body_methods">

		<div class="banner">
			<span class="type">Methods</span>
		    <h1><span class="title">RequestCore</span>
				</h1>
						<p>Container for all request-related methods.</p>
					</div>

		<div id="bodyContent">
			<div id="content">
				<div class="method">
	
	<div class="title">
		<strong>send_multi_request</strong> ( $handles )
	</div>

	<div class="description">
					<p>Sends the request using curl_multi_exec(), enabling parallel requests.</p>
		
					
									<h4>Access</h4>
																						<p>public</p>
																				
			
									<h4>Parameters</h4>
				<ul class="parameterList">
														<li>
												<tt>$handles</tt> - <em>array</em> (Required) <p>An indexed array of cURL handles to process simultaneously.</p>
					</li>
								</ul>

			
									<h4>Returns</h4>
																						<p><em>array</em> Post-processed cURL responses.</p>
																				
			
		
					<h4>Examples</h4>
			<div class="description highlight">
									<h5>Collect cURL handles for two requests, fire them, then display the response bodies.</h5>
					<pre class="code ln-"><code class="php">$http = new RequestCore();

$responses = $http-&gt;send_multi_request(array(
	$http-&gt;set_request_url('http://github.com/skyzyx/requestcore/raw/master/_tests/test_request.txt')-&gt;prep_request(),
	$http-&gt;set_request_url('http://github.com/skyzyx/requestcore/raw/master/_tests/test_request2.txt')-&gt;prep_request()
));

$bodies = array(
	$responses[0]-&gt;body,
	$responses[1]-&gt;body,
);

var_dump($bodies);</code></pre>
					<br><pre>array(2) {
  [0]=&gt;
  string(48) "abcdefghijklmnopqrstuvwxyz
0123456789
!@#$%^&amp;*()"
  [1]=&gt;
  string(48) ")(*&amp;^%$#@!
9876543210
zyxwvutsrqponmljkihgfedcba"
}</pre>
							</div>
		
		<h4>Source</h4>
		<p class="parent"><em>Method defined in <a href="../RequestCore/index.html">requestcore.class.php</a></em> | <a href="" class="showsource">Toggle source view</a> (43 lines)</p>
		<div class="source hide highlight">
			<pre class="code ln-618"><code class="php">public function send_multi_request($handles)
{
    // Initialize MultiCURL
    $multi_handle = curl_multi_init();

    // Loop through each of the CURL handles and add them to the MultiCURL request.
    foreach ($handles as $handle)
    {
        curl_multi_add_handle($multi_handle, $handle);
    }

    $count = 0;

    // Execute
    do
    {
        $status = curl_multi_exec($multi_handle, $active);
    }
    while ($status == CURLM_CALL_MULTI_PERFORM || $active);

    // Define this.
    $handles_post = array();

    // Retrieve each handle response
    foreach ($handles as $handle)
    {
        if (curl_errno($handle) == CURLE_OK)
        {
            $http = new $this-&gt;request_class(null);
            $handles_post[] = $http-&gt;process_response($handle, curl_multi_getcontent($handle));
        }
        else
        {
            throw new RequestCore_Exception(curl_error($handle));
        }

        // Explicitly close each cURL handle.
        curl_multi_remove_handle($multi_handle, $handle);
        curl_close($handle);
    }

    return $handles_post;
}
</code></pre>
		</div>
	</div>

	<script type="text/javascript" charset="utf-8">
	$(function() {

		// Syntax highlighting
		ChiliBook.automatic = false;
		ChiliBook.lineNumbers = true;
		$('div.highlight pre').chili();
		$('div.highlight pre ol li:even').addClass('odd');

		// Toggle source view
		$('a.showsource').click(function() {
			$('div.source').slideToggle('fast');
			return false;
		});
	});
	</script>

</div>
			</div>
		</div>
	</body>
</html>
